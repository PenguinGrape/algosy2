Препроцессинг с dfs: для каждой вершины запоминается растояние до корня и номер вершины, в которую мы придём если
пройдём из вершины v вверх по подвешенному дереву 2^i шагов (для метода двоичного подъема). После для каждого запроса
методом двоичного подъема находим общего предка и считаем расстояние между ними по формуле в строке 78